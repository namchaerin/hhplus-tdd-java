# hhplus-tdd-java
##1.개요
이 프로젝트는 동시성 문제를 해결하는 방법을 적용하여 사용자가 포인트를 충전 또는 사용하고자 할 때에 여러 요청이 한번에 들어오더라도 요청 순서대로 실행될 수 있도록 구현되었습니다.

##2. 동시성 제어의 개념
- 동시성 제어는 여러 스레드나 프로세스가 공유 자원에 동시에 접근할 때 발생할 수 있는 문제를 해결하기 위한 기법입니다. 동시성 문제는 크게 **상호 배제(Mutual Exclusion)**와 **데이터 일관성(Data Consistency)**에 관련된 문제입니다. 대표적인 동시성 문제로는 경합 조건(Race Condition), 기다림(Livelock), 교착 상태(Deadlock) 등이 있습니다.

##3. 동시성 해결 방법
 동시성 문제를 해결하기 위한 여러 가지 기법이 존재하며, 주로 **락(Lock)**을 이용한 방법이 많이 사용됩니다. 이 외에도 트랜잭션과 **데이터베이스 격리 수준(Isolation Levels)**을 활용할 수 있습니다.

###3.1. 락(Lock)
락은 자원에 대한 접근을 제어하는 기법으로, 한 스레드가 자원에 접근한 동안 다른 스레드는 자원에 접근하지 못하도록 잠그는 방식입니다. 자원을 잠그는 방법에는 여러 종류가 있습니다.

- 비관적 락(Pessimistic Locking):
자원을 즉시 잠그고, 다른 스레드는 잠금을 해제할 때까지 대기합니다.
예: ReentrantLock, synchronized.

- 낙관적 락(Optimistic Locking):
자원을 잠그지 않고, 업데이트할 때 충돌 여부를 확인합니다. 충돌이 발생하면, 작업을 다시 시도합니다.
예: 버전 관리, 타임스탬프.
###3.2. 트랜잭션과 격리 수준
 트랜잭션은 여러 작업을 하나의 논리적 단위로 묶어서 처리하는 방식입니다. 트랜잭션의 격리 수준을 통해 여러 트랜잭션이 동시에 실행될 때 일관성을 보장할 수 있습니다.

- Read Uncommitted: 다른 트랜잭션의 변경사항을 읽을 수 있음.
- Read Committed: 커밋된 데이터만 읽을 수 있음.
- Repeatable Read: 트랜잭션 중에 읽은 값은 변경되지 않음.
- Serializable: 가장 강력한 격리 수준으로, 한 트랜잭션이 완료될 때까지 다른 트랜잭션이 해당 데이터에 접근할 수 없음.
###3.3. 동시성 제어를 위한 주요 API
- ReentrantLock: 자바에서 제공하는 락 구현체로, lock(), unlock() 메서드를 사용하여 락을 제어할 수 있습니다. 이 락은 스레드가 여러 번 잠금을 획득할 수 있도록 해줍니다.

- synchronized: 메서드나 블록을 동기화하여 한 번에 하나의 스레드만 접근하도록 합니다.

- Atomic 클래스: AtomicInteger, AtomicLong 등은 원자적 연산을 제공하며, 락을 사용하지 않고도 동시성을 제어할 수 있습니다.

##4. ReentrantLock을 이용한 동시성 제어 구현
이 프로젝트에서는 `ReentrantLock`을 사용하여 동시성 제어를 구현하였습니다. 또한 데이터베이스와의 연결 없이 동시성 제어 테스트를 수행하기 위해, 병렬 쓰레드를 사용하여 동시성 충돌이 발생할 수 있는 환경을 시뮬레이션했습니다.

`ReentrantLock`은 자바에서 제공하는 명시적 락으로, 락을 획득한 스레드가 여러 번 잠금을 획득할 수 있는 특징을 가지고 있습니다. `lock()` 메서드로 락을 획득하고, `unlock()` 메서드로 락을 해제합니다. 만약 락 해제를 제대로 하지 않으면 **교착 상태(Deadlock)**가 발생할 위험이 있으니 주의해서 사용해야할 필요가 있습니다.
